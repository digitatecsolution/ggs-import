<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GGS Admin Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,700;0,900;1,400&family=Bebas+Neue&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px}
:root{
  --ink:#08090C;--ink2:#0C0D11;--surface:#111318;--card:#161820;--card2:#1C1E28;
  --border:rgba(255,255,255,0.07);--border2:rgba(255,255,255,0.04);
  --gold-deep:#9A6B0A;--gold:#C8891A;--gold-mid:#E09E28;--gold-bright:#F5B945;
  --teal:#0B6E5C;--teal-mid:#0D8A72;--teal-bright:#12B896;
  --green:#15803D;--red:#DC2626;
  --white:#F0EDE7;--muted:#5C5968;--muted2:#8C8898;
  --r:10px;--r2:16px;--r3:24px;--sidebar:260px;
}
body{background:var(--ink);color:var(--white);font-family:'Plus Jakarta Sans',sans-serif;overflow-x:hidden;line-height:1.6}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:var(--ink)}::-webkit-scrollbar-thumb{background:var(--gold);border-radius:4px}

/* LOGIN */
#loginPage{display:flex;align-items:center;justify-content:center;min-height:100vh;background:var(--ink2);background-image:linear-gradient(rgba(200,137,26,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(200,137,26,.03) 1px,transparent 1px);background-size:60px 60px}
.login-box{background:var(--card);border:1px solid rgba(200,137,26,.2);border-radius:var(--r3);padding:48px 40px;width:100%;max-width:420px;position:relative;overflow:hidden}
.login-box::before{content:'';position:absolute;top:0;inset-inline:0;height:3px;background:linear-gradient(90deg,transparent,var(--gold-deep),var(--gold-bright),var(--gold-deep),transparent)}
.login-logo{text-align:center;margin-bottom:32px}
.login-logo .name{font-family:'Playfair Display';font-size:2rem;font-weight:900}
.login-logo .name em{color:var(--gold-bright);font-style:italic}
.login-logo .tag{font-size:.62rem;color:var(--muted);letter-spacing:.2em;text-transform:uppercase;display:block;margin-top:4px}
.lf{display:flex;flex-direction:column;gap:6px;margin-bottom:16px}
.lf label{font-size:.62rem;font-weight:700;letter-spacing:.14em;text-transform:uppercase;color:var(--muted2)}
.lf input{background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:10px;padding:13px 16px;color:var(--white);font-family:'Plus Jakarta Sans';font-size:.9rem;outline:none;transition:.25s}
.lf input:focus{border-color:rgba(200,137,26,.5)}
.lf input::placeholder{color:var(--muted)}
.login-btn{width:100%;padding:15px;background:linear-gradient(135deg,var(--teal),var(--teal-mid),var(--teal-bright));color:#fff;font-weight:800;font-size:.95rem;border-radius:11px;border:none;cursor:pointer;font-family:'Plus Jakarta Sans';transition:.3s;margin-top:6px}
.login-btn:hover{transform:translateY(-2px);box-shadow:0 12px 36px rgba(18,184,150,.35)}
.login-err{background:rgba(220,38,38,.1);border:1px solid rgba(220,38,38,.25);border-radius:9px;padding:11px 14px;font-size:.8rem;color:#fca5a5;margin-top:12px;display:none}
.login-err.show{display:block}

/* APP */
#app{display:none;min-height:100vh}
.sidebar{position:fixed;top:0;left:0;bottom:0;width:var(--sidebar);background:var(--ink2);border-right:1px solid var(--border);display:flex;flex-direction:column;z-index:300;transition:transform .3s}
.sb-logo{padding:24px 20px 20px;border-bottom:1px solid var(--border)}
.sb-logo .name{font-family:'Playfair Display';font-size:1.3rem;font-weight:900}
.sb-logo .name em{color:var(--gold-bright);font-style:italic}
.sb-logo .tag{font-size:.52rem;color:var(--muted);letter-spacing:.18em;text-transform:uppercase;margin-top:3px;display:block}
.sb-nav{flex:1;padding:16px 12px;overflow-y:auto;display:flex;flex-direction:column;gap:2px}
.sb-sec{font-size:.52rem;letter-spacing:.2em;text-transform:uppercase;color:var(--muted);font-weight:700;padding:14px 8px 6px}
.sb-link{display:flex;align-items:center;gap:11px;padding:11px 14px;border-radius:10px;color:rgba(240,237,231,.4);font-size:.84rem;font-weight:600;cursor:pointer;transition:.22s;border:none;background:none;width:100%;text-align:left;font-family:'Plus Jakarta Sans'}
.sb-link:hover{color:var(--white);background:rgba(255,255,255,.05)}
.sb-link.active{color:var(--gold-bright);background:rgba(200,137,26,.1);border:1px solid rgba(200,137,26,.15)}
.sb-badge{margin-left:auto;background:var(--red);color:#fff;font-size:.55rem;font-weight:800;padding:2px 7px;border-radius:100px}
.sb-foot{padding:16px 12px;border-top:1px solid var(--border)}
.sb-user{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;background:rgba(255,255,255,.03);margin-bottom:8px}
.sb-av{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--gold-deep),var(--gold-bright));display:grid;place-items:center;font-weight:800;font-size:.78rem;color:var(--ink);flex-shrink:0}
.sb-uname{font-size:.8rem;font-weight:700;line-height:1.2}
.sb-uemail{font-size:.62rem;color:var(--muted2)}
.logout-btn{width:100%;padding:10px;background:rgba(220,38,38,.08);border:1px solid rgba(220,38,38,.2);border-radius:9px;color:#fca5a5;font-size:.78rem;font-weight:700;cursor:pointer;font-family:'Plus Jakarta Sans';transition:.2s}
.logout-btn:hover{background:rgba(220,38,38,.15)}
.main{margin-left:var(--sidebar);min-height:100vh;display:flex;flex-direction:column}
.topbar{background:rgba(8,9,12,.95);backdrop-filter:blur(30px);border-bottom:1px solid var(--border);padding:0 28px;height:68px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:200}
.tb-title{font-family:'Playfair Display';font-size:1.4rem;font-weight:900}
.tb-title em{color:var(--gold-bright);font-style:italic}
.tb-badge{display:flex;align-items:center;gap:6px;background:rgba(18,184,150,.08);border:1px solid rgba(18,184,150,.2);border-radius:100px;padding:6px 14px;font-size:.7rem;color:var(--teal-bright);font-weight:700}
.live-dot{width:6px;height:6px;border-radius:50%;background:var(--teal-bright);animation:lp 2s infinite}
@keyframes lp{0%,100%{box-shadow:0 0 0 0 rgba(18,184,150,.5)}50%{box-shadow:0 0 0 6px rgba(18,184,150,0)}}
.menu-btn{display:none;background:none;border:1px solid var(--border);border-radius:8px;width:38px;height:38px;align-items:center;justify-content:center;cursor:pointer;color:var(--white);font-size:1.1rem}
.content{flex:1;padding:28px}
.panel{display:none}.panel.active{display:block}

/* STATS */
.stats-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(195px,1fr));gap:16px;margin-bottom:28px}
.stat-card{background:var(--card);border:1px solid var(--border);border-radius:var(--r2);padding:22px;position:relative;overflow:hidden;transition:.3s}
.stat-card:hover{border-color:rgba(200,137,26,.2);transform:translateY(-2px)}
.stat-card::before{content:'';position:absolute;top:0;inset-inline:0;height:2px}
.sc-gold::before{background:linear-gradient(90deg,transparent,var(--gold),transparent)}
.sc-teal::before{background:linear-gradient(90deg,transparent,var(--teal-bright),transparent)}
.sc-red::before{background:linear-gradient(90deg,transparent,var(--red),transparent)}
.sc-purple::before{background:linear-gradient(90deg,transparent,#A78BFA,transparent)}
.stat-icon{font-size:1.5rem;margin-bottom:10px;display:block}
.stat-n{font-family:'Bebas Neue';font-size:2.3rem;color:var(--gold-bright);line-height:1;letter-spacing:.04em;display:block}
.stat-l{font-size:.62rem;color:var(--muted2);letter-spacing:.1em;text-transform:uppercase;margin-top:4px;display:block;font-weight:600}
.stat-sub{font-size:.7rem;color:var(--muted);margin-top:6px}

/* BTN */
.sec-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;gap:12px;flex-wrap:wrap}
.sec-hdr h2{font-family:'Playfair Display';font-size:1.5rem;font-weight:900}
.sec-hdr h2 em{color:var(--gold-bright);font-style:italic}
.btn{display:inline-flex;align-items:center;gap:7px;padding:10px 20px;border-radius:10px;font-family:'Plus Jakarta Sans';font-size:.82rem;font-weight:700;cursor:pointer;transition:.25s;border:none}
.btn-teal{background:linear-gradient(135deg,var(--teal),var(--teal-mid));color:#fff;box-shadow:0 4px 16px rgba(13,138,114,.2)}
.btn-teal:hover{box-shadow:0 8px 28px rgba(18,184,150,.35);transform:translateY(-1px)}
.btn-gold{background:rgba(200,137,26,.1);border:1px solid rgba(200,137,26,.25);color:var(--gold-bright)}
.btn-gold:hover{background:rgba(200,137,26,.18)}
.btn-red{background:rgba(220,38,38,.1);border:1px solid rgba(220,38,38,.2);color:#fca5a5}
.btn-red:hover{background:rgba(220,38,38,.18)}
.btn-ghost{background:rgba(255,255,255,.04);border:1px solid var(--border);color:var(--muted2)}
.btn-ghost:hover{color:var(--white);background:rgba(255,255,255,.08)}

/* TABLE */
.tbl-wrap{background:var(--card);border:1px solid var(--border);border-radius:var(--r2);overflow:hidden}
.tbl-toolbar{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.tbl-search{background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:9px;padding:9px 14px;color:var(--white);font-family:'Plus Jakarta Sans';font-size:.82rem;outline:none;min-width:200px;transition:.2s}
.tbl-search:focus{border-color:rgba(200,137,26,.4)}
.tbl-search::placeholder{color:var(--muted)}
.ftab{background:none;border:1px solid var(--border);border-radius:8px;padding:7px 14px;color:var(--muted2);font-size:.75rem;font-weight:600;cursor:pointer;transition:.2s;font-family:'Plus Jakarta Sans'}
.ftab.on{background:rgba(200,137,26,.1);border-color:rgba(200,137,26,.3);color:var(--gold-bright)}
table{width:100%;border-collapse:collapse}
th{padding:12px 16px;text-align:left;font-size:.62rem;letter-spacing:.14em;text-transform:uppercase;color:var(--muted);font-weight:700;border-bottom:1px solid var(--border);background:rgba(255,255,255,.02)}
td{padding:14px 16px;font-size:.84rem;border-bottom:1px solid var(--border2);vertical-align:middle}
tr:last-child td{border-bottom:none}
tr:hover td{background:rgba(255,255,255,.015)}
.td-name{font-weight:700;margin-bottom:2px}
.td-sub{font-size:.7rem;color:var(--muted2)}
.td-price{font-family:'Playfair Display';font-size:1.05rem;font-weight:900;color:var(--gold-bright)}
.badge{display:inline-flex;align-items:center;padding:3px 10px;border-radius:100px;font-size:.62rem;font-weight:700;letter-spacing:.06em}
.b-active{background:rgba(21,128,61,.15);border:1px solid rgba(21,128,61,.3);color:#4ade80}
.b-false,.b-hidden{background:rgba(92,89,104,.12);border:1px solid rgba(92,89,104,.3);color:var(--muted2)}
.b-tech{background:rgba(37,99,235,.1);border:1px solid rgba(37,99,235,.2);color:#60a5fa}
.b-fashion{background:rgba(219,39,119,.1);border:1px solid rgba(219,39,119,.2);color:#f472b6}
.b-paid,.b-delivered,.b-completed{background:rgba(21,128,61,.15);border:1px solid rgba(21,128,61,.3);color:#4ade80}
.b-pending{background:rgba(234,179,8,.12);border:1px solid rgba(234,179,8,.3);color:#facc15}
.b-processing{background:rgba(37,99,235,.1);border:1px solid rgba(37,99,235,.2);color:#60a5fa}
.b-shipped{background:rgba(139,92,246,.1);border:1px solid rgba(139,92,246,.2);color:#a78bfa}
.act-row{display:flex;gap:6px}
.act-btn{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;border:none;font-size:.85rem;transition:.2s}
.act-edit{background:rgba(200,137,26,.1);color:var(--gold)}.act-edit:hover{background:rgba(200,137,26,.2)}
.act-del{background:rgba(220,38,38,.08);color:#fca5a5}.act-del:hover{background:rgba(220,38,38,.18)}
.act-eye{background:rgba(255,255,255,.05);color:var(--muted2)}.act-eye:hover{background:rgba(255,255,255,.1);color:var(--white)}
.act-wa{background:rgba(37,211,102,.1);color:#25D366}.act-wa:hover{background:rgba(37,211,102,.2)}

/* MODAL */
.modal-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(12px);z-index:600;place-items:center;padding:20px}
.modal-bg.open{display:grid}
.modal-box{background:var(--card);border:1px solid rgba(200,137,26,.2);border-radius:var(--r3);padding:36px;max-width:580px;width:100%;max-height:90vh;overflow-y:auto;position:relative}
.modal-box::before{content:'';position:absolute;top:0;inset-inline:0;height:3px;background:linear-gradient(90deg,transparent,var(--gold-deep),var(--gold-bright),var(--gold-deep),transparent);border-radius:var(--r3) var(--r3) 0 0}
.modal-box::-webkit-scrollbar{width:3px}
.modal-x{position:absolute;top:14px;right:14px;background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:50%;width:32px;height:32px;display:grid;place-items:center;cursor:pointer;color:var(--muted2);transition:.2s;font-size:.85rem}
.modal-x:hover{color:var(--white)}
.modal-title{font-family:'Playfair Display';font-size:1.6rem;font-weight:900;margin-bottom:6px}
.modal-sub{font-size:.78rem;color:var(--muted2);margin-bottom:24px}
.mf{display:flex;flex-direction:column;gap:6px;margin-bottom:14px}
.mf label{font-size:.62rem;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:var(--muted2)}
.mf input,.mf select,.mf textarea{background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:9px;padding:11px 14px;color:var(--white);font-family:'Plus Jakarta Sans';font-size:.86rem;outline:none;transition:.2s;width:100%;-webkit-appearance:none}
.mf input:focus,.mf select:focus,.mf textarea:focus{border-color:rgba(200,137,26,.45)}
.mf input::placeholder,.mf textarea::placeholder{color:var(--muted)}
.mf select option{background:var(--card);color:var(--white)}
.mf textarea{min-height:80px;resize:vertical}
.mf-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.save-btn{width:100%;padding:14px;background:linear-gradient(135deg,var(--teal),var(--teal-mid),var(--teal-bright));color:#fff;font-weight:800;font-size:.95rem;border-radius:11px;border:none;cursor:pointer;font-family:'Plus Jakarta Sans';transition:.3s;margin-top:8px;display:flex;align-items:center;justify-content:center;gap:8px}
.save-btn:hover{transform:translateY(-2px);box-shadow:0 12px 36px rgba(18,184,150,.35)}

/* IMAGE UPLOAD */
.img-upload-area{border:2px dashed rgba(200,137,26,.25);border-radius:12px;padding:24px;text-align:center;cursor:pointer;transition:.25s;background:rgba(200,137,26,.03)}
.img-upload-area:hover,.img-upload-area.drag{border-color:var(--gold);background:rgba(200,137,26,.06)}
.upload-icon{font-size:2rem;display:block;margin-bottom:8px;opacity:.5}
.upload-text{font-size:.8rem;color:var(--muted2)}
.upload-text strong{color:var(--gold-bright)}
.img-preview{width:100%;max-height:140px;object-fit:cover;border-radius:9px;margin-top:10px;display:none}
.img-or{text-align:center;font-size:.7rem;color:var(--muted);margin:8px 0}
.img-url-row{display:flex;gap:8px;align-items:center}
.img-url-row input{flex:1}

/* SETTINGS */
.settings-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:18px}
.settings-card{background:var(--card);border:1px solid var(--border);border-radius:var(--r2);padding:26px}
.settings-card h3{font-size:1rem;font-weight:800;margin-bottom:4px}
.settings-card p{font-size:.75rem;color:var(--muted2);margin-bottom:20px}
.sf{display:flex;flex-direction:column;gap:6px;margin-bottom:14px}
.sf label{font-size:.6rem;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:var(--muted2)}
.sf input,.sf select,.sf textarea{background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:9px;padding:10px 13px;color:var(--white);font-family:'Plus Jakarta Sans';font-size:.84rem;outline:none;transition:.2s;width:100%}
.sf input:focus,.sf select:focus,.sf textarea:focus{border-color:rgba(200,137,26,.45)}
.sf input::placeholder{color:var(--muted)}
.sf textarea{min-height:70px;resize:vertical}
.toggle-row{display:flex;align-items:center;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--border2)}
.toggle-row:last-child{border-bottom:none}
.tl{font-size:.84rem;font-weight:600}.ts{font-size:.7rem;color:var(--muted2);margin-top:2px}
.toggle{position:relative;width:44px;height:24px;cursor:pointer;flex-shrink:0}
.toggle input{opacity:0;width:0;height:0}
.toggle-slider{position:absolute;inset:0;background:rgba(255,255,255,.1);border-radius:100px;transition:.3s}
.toggle-slider::before{content:'';position:absolute;width:18px;height:18px;left:3px;top:3px;background:#fff;border-radius:50%;transition:.3s}
.toggle input:checked+.toggle-slider{background:var(--teal-mid)}
.toggle input:checked+.toggle-slider::before{transform:translateX(20px)}

/* ORDER DETAIL */
.od{background:var(--card2);border-radius:var(--r);padding:16px;margin-top:12px}
.od-row{display:flex;justify-content:space-between;font-size:.8rem;padding:6px 0;border-bottom:1px solid var(--border2)}
.od-row:last-child{border-bottom:none}
.od-row span:first-child{color:var(--muted2)}
.od-row span:last-child{font-weight:600;text-align:right;max-width:60%}
.status-sel{background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:8px;padding:7px 12px;color:var(--white);font-family:'Plus Jakarta Sans';font-size:.78rem;cursor:pointer;outline:none;-webkit-appearance:none}

/* QUICK CARDS */
.quick-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin-bottom:28px}
.quick-card{background:var(--card);border:1px solid var(--border);border-radius:var(--r2);padding:22px;cursor:pointer;transition:.3s;text-align:center}
.quick-card:hover{transform:translateY(-4px);border-color:rgba(200,137,26,.25);box-shadow:0 16px 40px rgba(0,0,0,.4)}
.qc-icon{font-size:2rem;display:block;margin-bottom:10px}
.qc-title{font-size:.9rem;font-weight:800;margin-bottom:4px}
.qc-sub{font-size:.7rem;color:var(--muted2)}
.recent-wrap{background:var(--card);border:1px solid var(--border);border-radius:var(--r2);overflow:hidden}
.rw-hdr{padding:18px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.rw-hdr h3{font-size:1rem;font-weight:800}

/* MISC */
.empty-state{text-align:center;padding:60px 20px;color:var(--muted)}
.empty-state .ei{font-size:3rem;display:block;margin-bottom:14px;opacity:.3}
.empty-state p{font-size:.88rem}
.loader{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.2);border-top-color:var(--teal-bright);border-radius:50%;animation:spin .6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.page-loader{display:flex;align-items:center;justify-content:center;padding:60px;color:var(--muted);gap:12px;font-size:.88rem}
#adminToast{position:fixed;bottom:28px;left:50%;transform:translateX(-50%);z-index:9999;pointer-events:none;transition:opacity .3s;opacity:0;white-space:nowrap}
.toast-inner{padding:12px 24px;border-radius:11px;font-size:.84rem;font-weight:700;font-family:'Plus Jakarta Sans'}
.t-success{background:rgba(13,138,114,.15);border:1px solid rgba(18,184,150,.35);color:#34d399}
.t-error{background:rgba(220,38,38,.12);border:1px solid rgba(220,38,38,.3);color:#fca5a5}
.t-info{background:rgba(200,137,26,.1);border:1px solid rgba(200,137,26,.3);color:var(--gold-bright)}
.sb-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:299}
.confirm-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(8px);z-index:700;place-items:center}
.confirm-bg.open{display:grid}
.confirm-box{background:var(--card);border:1px solid rgba(220,38,38,.25);border-radius:var(--r2);padding:32px;max-width:360px;width:100%;text-align:center}
.confirm-icon{font-size:2.5rem;display:block;margin-bottom:14px}
.confirm-title{font-size:1.1rem;font-weight:800;margin-bottom:8px}
.confirm-msg{font-size:.82rem;color:var(--muted2);margin-bottom:24px;line-height:1.7}
.confirm-row{display:flex;gap:10px;justify-content:center}

@media(max-width:900px){
  .sidebar{transform:translateX(-100%)}.sidebar.open{transform:translateX(0)}
  .sb-overlay.show{display:block}.main{margin-left:0}.menu-btn{display:flex}
  .topbar{padding:0 16px}.content{padding:16px}.mf-row{grid-template-columns:1fr}
}
@media(max-width:500px){.stats-row{grid-template-columns:1fr 1fr}.login-box{padding:32px 22px}}
</style>
</head>
<body>

<div id="loginPage">
  <div class="login-box">
    <div class="login-logo">
      <div class="name">GGS <em>Global</em></div>
      <span class="tag">Admin Dashboard ¬∑ Secure Access</span>
    </div>
    <div style="font-size:1.1rem;font-weight:700;margin-bottom:6px">Welcome Back üëã</div>
    <div style="font-size:.78rem;color:var(--muted2);margin-bottom:28px">Sign in to manage your store, products and orders.</div>
    <div class="lf"><label>Email Address</label><input type="email" id="loginEmail" placeholder="ggsglobalconsult@gmail.com"></div>
    <div class="lf"><label>Password</label><input type="password" id="loginPass" placeholder="Your password" onkeydown="if(event.key==='Enter')doLogin()"></div>
    <button class="login-btn" onclick="doLogin()" id="loginBtn">üîê Sign In to Admin</button>
    <div class="login-err" id="loginErr"></div>
  </div>
</div>

<div id="app">
  <div class="sb-overlay" id="sbOverlay" onclick="toggleSB()"></div>
  <aside class="sidebar" id="sidebar">
    <div class="sb-logo"><div class="name">GGS <em>Global</em></div><span class="tag">Admin Dashboard</span></div>
    <nav class="sb-nav">
      <div class="sb-sec">Main</div>
      <button class="sb-link active" onclick="goto('overview')" id="nav-overview">üìä Overview</button>
      <button class="sb-link" onclick="goto('products')" id="nav-products">üìã Products</button>
      <button class="sb-link" onclick="goto('orders')" id="nav-orders">üì¶ Orders <span class="sb-badge" id="pendingBadge" style="display:none">0</span></button>
      <div class="sb-sec">Manage</div>
      <button class="sb-link" onclick="goto('settings')" id="nav-settings">‚öôÔ∏è Site Settings</button>
      <button class="sb-link" onclick="goto('referrals')" id="nav-referrals">üéÅ Referrals</button>
      <div class="sb-sec">Store</div>
      <button class="sb-link" onclick="window.open('index.html','_blank')">üè™ View Storefront</button>
      <button class="sb-link" onclick="window.open('https://wa.me/2348142717585','_blank')">üí¨ WhatsApp</button>
    </nav>
    <div class="sb-foot">
      <div class="sb-user"><div class="sb-av" id="sbAv">GG</div><div><div class="sb-uname">GGS Admin</div><div class="sb-uemail" id="sbEmail">‚Äî</div></div></div>
      <button class="logout-btn" onclick="doLogout()">üö™ Sign Out</button>
    </div>
  </aside>

  <main class="main">
    <div class="topbar">
      <div style="display:flex;align-items:center;gap:14px">
        <button class="menu-btn" onclick="toggleSB()">‚ò∞</button>
        <div class="tb-title" id="topTitle">Overview</div>
      </div>
      <div class="tb-badge"><span class="live-dot"></span> Live Store</div>
    </div>
    <div class="content">

      <!-- OVERVIEW -->
      <div class="panel active" id="panel-overview">
        <div class="stats-row">
          <div class="stat-card sc-gold"><span class="stat-icon">üí∞</span><span class="stat-n" id="sRev">‚Ç¶0</span><span class="stat-l">Total Revenue</span><span class="stat-sub">All paid orders</span></div>
          <div class="stat-card sc-teal"><span class="stat-icon">üì¶</span><span class="stat-n" id="sOrd">0</span><span class="stat-l">Total Orders</span><span class="stat-sub">Confirmed</span></div>
          <div class="stat-card sc-purple"><span class="stat-icon">üìã</span><span class="stat-n" id="sProd">0</span><span class="stat-l">Active Products</span><span class="stat-sub">Live on store</span></div>
          <div class="stat-card sc-red"><span class="stat-icon">üïê</span><span class="stat-n" id="sPend">0</span><span class="stat-l">Pending Orders</span><span class="stat-sub">Need action</span></div>
        </div>
        <div class="quick-grid">
          <div class="quick-card" onclick="goto('products');setTimeout(openAddModal,300)"><span class="qc-icon">‚ûï</span><div class="qc-title">Add New Product</div><div class="qc-sub">Add to live catalog</div></div>
          <div class="quick-card" onclick="goto('orders')"><span class="qc-icon">üì¶</span><div class="qc-title">View All Orders</div><div class="qc-sub">Manage & update</div></div>
          <div class="quick-card" onclick="goto('settings')"><span class="qc-icon">‚öôÔ∏è</span><div class="qc-title">Site Settings</div><div class="qc-sub">Slots, countdown</div></div>
          <div class="quick-card" onclick="window.open('index.html','_blank')"><span class="qc-icon">üè™</span><div class="qc-title">View Storefront</div><div class="qc-sub">See live page</div></div>
        </div>
        <div class="recent-wrap">
          <div class="rw-hdr"><h3>üì¶ Recent Orders</h3><button class="btn btn-ghost" style="font-size:.75rem;padding:7px 14px" onclick="goto('orders')">View All ‚Üí</button></div>
          <div id="recentBody"><div class="page-loader"><span class="loader"></span> Loading...</div></div>
        </div>
      </div>

      <!-- PRODUCTS -->
      <div class="panel" id="panel-products">
        <div class="sec-hdr"><h2>Product <em>Catalog</em></h2><button class="btn btn-teal" onclick="openAddModal()">‚ûï Add Product</button></div>
        <div class="tbl-wrap">
          <div class="tbl-toolbar">
            <input class="tbl-search" placeholder="üîç Search products..." oninput="renderProds()" id="pSearch">
            <button class="ftab on" onclick="setCat(this,'all')">All</button>
            <button class="ftab" onclick="setCat(this,'tech')">üì± Tech</button>
            <button class="ftab" onclick="setCat(this,'fashion')">üëú Fashion</button>
            <button class="ftab" onclick="setCat(this,'hidden')">üëÅ Hidden</button>
          </div>
          <div id="prodBody"><div class="page-loader"><span class="loader"></span> Loading products...</div></div>
        </div>
      </div>

      <!-- ORDERS -->
      <div class="panel" id="panel-orders">
        <div class="sec-hdr"><h2>Order <em>Management</em></h2><button class="btn btn-ghost" onclick="exportCSV()">üì• Export CSV</button></div>
        <div class="tbl-wrap">
          <div class="tbl-toolbar">
            <input class="tbl-search" placeholder="üîç Search name, email, ref..." oninput="renderOrds()" id="oSearch">
            <button class="ftab on" onclick="setOrdStatus(this,'all')">All</button>
            <button class="ftab" onclick="setOrdStatus(this,'paid')">‚úÖ Paid</button>
            <button class="ftab" onclick="setOrdStatus(this,'processing')">üîÑ Processing</button>
            <button class="ftab" onclick="setOrdStatus(this,'shipped')">üöö Shipped</button>
            <button class="ftab" onclick="setOrdStatus(this,'delivered')">üéâ Delivered</button>
          </div>
          <div id="ordBody"><div class="page-loader"><span class="loader"></span> Loading orders...</div></div>
        </div>
      </div>

      <!-- SETTINGS -->
      <div class="panel" id="panel-settings">
        <div class="sec-hdr"><h2>Site <em>Settings</em></h2><button class="btn btn-teal" onclick="saveSettings()">üíæ Save All Changes</button></div>
        <div class="settings-grid">
          <div class="settings-card"><h3>üì£ Announcement Bar</h3><p>Scrolling text at the very top of your storefront.</p><div class="sf"><label>Text</label><textarea id="sAnn" placeholder="‚ö° Pre-Order Round 2 LIVE..."></textarea></div></div>
          <div class="settings-card"><h3>‚è±Ô∏è Countdown & Urgency</h3><p>Timer and slot numbers shown on storefront.</p>
            <div class="sf"><label>Deadline</label><input type="datetime-local" id="sDL"></div>
            <div class="sf"><label>Total Slots</label><input type="number" id="sTotal" placeholder="15"></div>
            <div class="sf"><label>Slots Remaining</label><input type="number" id="sRem" placeholder="7"></div>
            <div class="sf"><label>Round Label</label><input type="text" id="sRound" placeholder="Round 2"></div>
          </div>
          <div class="settings-card"><h3>üöö Delivery Fees</h3><p>Fees after goods arrive from China.</p>
            <div class="sf"><label>Port Harcourt Fee (‚Ç¶)</label><input type="number" id="sPH" placeholder="0"></div>
            <div class="sf"><label>Other States Fee (‚Ç¶)</label><input type="number" id="sOther" placeholder="5000"></div>
          </div>
          <div class="settings-card"><h3>üì± Contact</h3><p>Business WhatsApp number site-wide.</p><div class="sf"><label>WhatsApp Number (no +)</label><input type="text" id="sWA" placeholder="2348142717585"></div></div>
          <div class="settings-card"><h3>üîß Site Controls</h3><p>Quick site-wide toggles.</p>
            <div class="toggle-row"><div><div class="tl">Maintenance Mode</div><div class="ts">Show maintenance page</div></div><label class="toggle"><input type="checkbox" id="sMaint"><span class="toggle-slider"></span></label></div>
            <div class="toggle-row"><div><div class="tl">Accepting Orders</div><div class="ts">Allow checkout</div></div><label class="toggle"><input type="checkbox" id="sAccept" checked><span class="toggle-slider"></span></label></div>
          </div>
          <div class="settings-card"><h3>üéÅ Referral Rewards</h3><p>Cash/credit per referral tier (‚Ç¶).</p>
            <div class="sf"><label>ü•â Bronze (1 ref)</label><input type="number" id="rB" placeholder="25000"></div>
            <div class="sf"><label>ü•à Silver (3 refs)</label><input type="number" id="rS" placeholder="100000"></div>
            <div class="sf"><label>ü•á Gold (5 refs)</label><input type="number" id="rG" placeholder="200000"></div>
            <div class="sf"><label>üíé Platinum (10 refs)</label><input type="number" id="rP" placeholder="500000"></div>
          </div>
        </div>
      </div>

      <!-- REFERRALS -->
      <div class="panel" id="panel-referrals">
        <div class="sec-hdr"><h2>Referral <em>Tracker</em></h2></div>
        <div class="tbl-wrap">
          <div class="tbl-toolbar"><input class="tbl-search" placeholder="üîç Search referral codes..." oninput="filterRefs(this.value)"></div>
          <div id="refBody"><div class="page-loader"><span class="loader"></span> Loading referrals...</div></div>
        </div>
      </div>

    </div>
  </main>
</div>

<!-- PRODUCT MODAL -->
<div class="modal-bg" id="prodModal">
  <div class="modal-box">
    <button class="modal-x" onclick="closeProdModal()">‚úï</button>
    <div class="modal-title" id="prodModalTitle">Add New Product</div>
    <div class="modal-sub">All changes go live on the storefront instantly.</div>
    <input type="hidden" id="editId">
    <div class="mf-row">
      <div class="mf"><label>Product Name</label><input type="text" id="pName" placeholder="iPhone 15 Pro Max"></div>
      <div class="mf"><label>Category</label><select id="pCat"><option value="tech">üì± Tech & Gadgets</option><option value="fashion">üëú Fashion & Lifestyle</option></select></div>
    </div>
    <div class="mf-row">
      <div class="mf"><label>Price (‚Ç¶)</label><input type="number" id="pPrice" placeholder="2100000"></div>
      <div class="mf"><label>Icon (emoji)</label><input type="text" id="pIcon" placeholder="üì±" maxlength="4"></div>
    </div>
    <div class="mf"><label>Short Spec / Subtitle</label><input type="text" id="pSpec" placeholder="256GB ¬∑ All Colors ¬∑ Factory Sealed"></div>
    <div class="mf"><label>Variants (one per line)</label><textarea id="pVars" placeholder="Natural Titanium&#10;Blue Titanium&#10;White Titanium"></textarea></div>
    <div class="mf-row">
      <div class="mf"><label>Badge Type</label><select id="pBadge"><option value="">No Badge</option><option value="hot">üî• Hot</option><option value="new">üÜï New</option><option value="pick">üí∞ Pick</option></select></div>
      <div class="mf"><label>Badge Text</label><input type="text" id="pBadgeTxt" placeholder="üî• Bestseller"></div>
    </div>
    <div class="mf">
      <label>Product Image</label>
      <div class="img-upload-area" id="uploadArea" onclick="document.getElementById('imgFile').click()" ondragover="ev.preventDefault();this.classList.add('drag')" ondragleave="this.classList.remove('drag')" ondrop="dropImg(event)">
        <span class="upload-icon">üñºÔ∏è</span>
        <div class="upload-text"><strong>Click to upload photo</strong> or drag & drop<br>JPG, PNG max 5MB</div>
        <img class="img-preview" id="imgPrev">
      </div>
      <input type="file" id="imgFile" accept="image/*" style="display:none" onchange="onFile(this)">
      <div class="img-or">‚Äî or paste image URL below ‚Äî</div>
      <div class="img-url-row">
        <input type="text" class="mf input" id="pImg" placeholder="https://images.unsplash.com/..." style="background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:9px;padding:11px 14px;color:var(--white);font-family:'Plus Jakarta Sans';font-size:.86rem;outline:none;width:100%">
        <button class="btn btn-gold" onclick="prevUrl()" style="white-space:nowrap;padding:9px 14px;font-size:.75rem">Preview</button>
      </div>
    </div>
    <div class="mf"><label>Visibility</label><select id="pActive"><option value="true">‚úÖ Active ‚Äî Visible on storefront</option><option value="false">üëÅ Hidden ‚Äî Not shown to customers</option></select></div>
    <button class="save-btn" onclick="saveProd()" id="saveProdBtn">üíæ Save Product to Firebase</button>
  </div>
</div>

<!-- ORDER MODAL -->
<div class="modal-bg" id="ordModal">
  <div class="modal-box">
    <button class="modal-x" onclick="closeOrdModal()">‚úï</button>
    <div class="modal-title">Order Details</div>
    <div class="modal-sub" id="ordRef">‚Äî</div>
    <div id="ordDetail"></div>
  </div>
</div>

<!-- CONFIRM -->
<div class="confirm-bg" id="confBg">
  <div class="confirm-box">
    <span class="confirm-icon">‚ö†Ô∏è</span>
    <div class="confirm-title" id="confTitle">Are you sure?</div>
    <div class="confirm-msg" id="confMsg">This cannot be undone.</div>
    <div class="confirm-row">
      <button class="btn btn-ghost" onclick="closeConf()">Cancel</button>
      <button class="btn btn-red" id="confOk">Delete</button>
    </div>
  </div>
</div>

<div id="adminToast"><div class="toast-inner" id="toastEl"></div></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, collection, doc, getDocs, getDoc, addDoc, setDoc, updateDoc, deleteDoc, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const app = initializeApp({
  apiKey:"AIzaSyCGU14FHH82Ja5Bx9ZE3ImlePoyKvZLdYg",
  authDomain:"ggs-global.firebaseapp.com",
  projectId:"ggs-global",
  storageBucket:"ggs-global.firebasestorage.app",
  messagingSenderId:"688407888100",
  appId:"1:688407888100:web:a9f3e068ca9624e3b66cf1"
});
const auth = getAuth(app);
const db = getFirestore(app);

let prods=[], ords=[], prodCatFilter='all', ordStatusFilter='all', uploadFile=null;
const fmt = n => '‚Ç¶'+(n||0).toLocaleString('en-NG');
const esc = s => String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
const sLabel = s => ({processing:'üîÑ Processing',shipped:'üöö Shipped',delivered:'üéâ Delivered',paid:'‚úÖ Paid',pending:'‚è≥ Pending',completed:'‚úÖ Completed',failed:'‚ùå Failed'}[s]||s);

// AUTH
onAuthStateChanged(auth, u => {
  if(u){
    document.getElementById('loginPage').style.display='none';
    document.getElementById('app').style.display='block';
    document.getElementById('sbEmail').textContent=u.email;
    document.getElementById('sbAv').textContent=u.email.substring(0,2).toUpperCase();
    loadAll();
  } else {
    document.getElementById('loginPage').style.display='flex';
    document.getElementById('app').style.display='none';
  }
});

window.doLogin = async function(){
  const em=document.getElementById('loginEmail').value.trim();
  const pw=document.getElementById('loginPass').value;
  const btn=document.getElementById('loginBtn');
  const err=document.getElementById('loginErr');
  err.classList.remove('show');
  if(!em||!pw){err.textContent='Please enter email and password.';err.classList.add('show');return;}
  btn.textContent='Signing in...';btn.disabled=true;
  try{ await signInWithEmailAndPassword(auth,em,pw); }
  catch(e){
    const m={'auth/wrong-password':'Incorrect password.','auth/user-not-found':'No account found.','auth/invalid-email':'Invalid email.','auth/invalid-credential':'Incorrect email or password.','auth/too-many-requests':'Too many attempts. Wait a moment.'};
    err.textContent=m[e.code]||'Error: '+e.message;err.classList.add('show');
    btn.textContent='üîê Sign In to Admin';btn.disabled=false;
  }
}

window.doLogout = async function(){ await signOut(auth); }

// LOAD
async function loadAll(){ await loadProds(); await loadOrds(); await loadSettings(); }

// PRODUCTS
async function loadProds(){
  try{
    const snap=await getDocs(collection(db,'products'));
    prods=snap.docs.map(d=>({fid:d.id,...d.data()})).sort((a,b)=>(a.sortOrder||0)-(b.sortOrder||0));
    renderProds();
    document.getElementById('sProd').textContent=prods.filter(p=>p.active!==false).length;
  }catch(e){ document.getElementById('prodBody').innerHTML=`<div class="empty-state"><span class="ei">‚ùå</span><p>${e.message}</p></div>`; }
}

window.renderProds = function(){
  const q=(document.getElementById('pSearch')?.value||'').toLowerCase();
  let list=[...prods];
  if(prodCatFilter==='tech') list=list.filter(p=>p.category==='tech');
  else if(prodCatFilter==='fashion') list=list.filter(p=>p.category==='fashion');
  else if(prodCatFilter==='hidden') list=list.filter(p=>p.active===false);
  if(q) list=list.filter(p=>p.name?.toLowerCase().includes(q)||p.spec?.toLowerCase().includes(q));
  const b=document.getElementById('prodBody');
  if(!list.length){b.innerHTML='<div class="empty-state"><span class="ei">üì≠</span><p>No products found.</p></div>';return;}
  b.innerHTML=`<table><thead><tr><th>Product</th><th>Category</th><th>Price</th><th>Status</th><th>Actions</th></tr></thead><tbody>${list.map(p=>`
    <tr>
      <td><div style="display:flex;align-items:center;gap:12px">
        <div style="width:44px;height:44px;border-radius:8px;background:var(--card2);display:flex;align-items:center;justify-content:center;font-size:1.4rem;flex-shrink:0;overflow:hidden">${p.img?`<img src="${esc(p.img)}" style="width:100%;height:100%;object-fit:cover;border-radius:8px">`:p.icon||'üì¶'}</div>
        <div><div class="td-name">${esc(p.name)}</div><div class="td-sub">${esc((p.spec||'').substring(0,55))}${(p.spec||'').length>55?'‚Ä¶':''}</div></div>
      </div></td>
      <td><span class="badge b-${p.category}">${p.category==='tech'?'üì± Tech':'üëú Fashion'}</span></td>
      <td><div class="td-price">${fmt(p.price)}</div></td>
      <td><span class="badge ${p.active!==false?'b-active':'b-hidden'}">${p.active!==false?'‚úÖ Active':'üëÅ Hidden'}</span></td>
      <td><div class="act-row">
        <button class="act-btn act-edit" onclick="openEdit('${p.fid}')" title="Edit">‚úèÔ∏è</button>
        <button class="act-btn act-eye" onclick="toggleVis('${p.fid}',${p.active!==false})" title="Toggle">${p.active!==false?'üëÅ':'üö´'}</button>
        <button class="act-btn act-del" onclick="confDel('${p.fid}','${esc(p.name)}')" title="Delete">üóëÔ∏è</button>
      </div></td>
    </tr>`).join('')}</tbody></table>`;
}

window.setCat = function(el,cat){
  document.querySelectorAll('#panel-products .ftab').forEach(t=>t.classList.remove('on'));
  el.classList.add('on');prodCatFilter=cat;renderProds();
}

window.openAddModal = function(){
  document.getElementById('prodModalTitle').textContent='Add New Product';
  document.getElementById('editId').value='';
  ['pName','pSpec','pVars','pBadgeTxt','pImg'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('pCat').value='tech';
  document.getElementById('pPrice').value='';
  document.getElementById('pIcon').value='';
  document.getElementById('pBadge').value='';
  document.getElementById('pActive').value='true';
  document.getElementById('imgPrev').style.display='none';
  uploadFile=null;
  document.getElementById('prodModal').classList.add('open');
}

window.openEdit = function(fid){
  const p=prods.find(x=>x.fid===fid);if(!p)return;
  document.getElementById('prodModalTitle').textContent='Edit Product';
  document.getElementById('editId').value=fid;
  document.getElementById('pName').value=p.name||'';
  document.getElementById('pCat').value=p.category||'tech';
  document.getElementById('pPrice').value=p.price||'';
  document.getElementById('pIcon').value=p.icon||'';
  document.getElementById('pSpec').value=p.spec||'';
  document.getElementById('pVars').value=(p.variants||[]).join('\n');
  document.getElementById('pBadge').value=p.badge||'';
  document.getElementById('pBadgeTxt').value=p.badgeText||'';
  document.getElementById('pImg').value=p.img||'';
  document.getElementById('pActive').value=p.active===false?'false':'true';
  const prev=document.getElementById('imgPrev');
  if(p.img){prev.src=p.img;prev.style.display='block';}else{prev.style.display='none';}
  uploadFile=null;
  document.getElementById('prodModal').classList.add('open');
}

window.closeProdModal = function(){document.getElementById('prodModal').classList.remove('open');}

window.saveProd = async function(){
  const btn=document.getElementById('saveProdBtn');
  const fid=document.getElementById('editId').value;
  const name=document.getElementById('pName').value.trim();
  const price=parseInt(document.getElementById('pPrice').value);
  if(!name){toast('Product name required','error');return;}
  if(!price||price<0){toast('Enter valid price','error');return;}
  btn.innerHTML='<span class="loader"></span> Saving...';btn.disabled=true;
  let img=document.getElementById('pImg').value.trim();
  if(uploadFile){
    img=await new Promise(res=>{const r=new FileReader();r.onload=e=>res(e.target.result);r.readAsDataURL(uploadFile);});
  }
  const vars=document.getElementById('pVars').value.split('\n').map(v=>v.trim()).filter(Boolean);
  const data={name,price,category:document.getElementById('pCat').value,icon:document.getElementById('pIcon').value||'üì¶',spec:document.getElementById('pSpec').value.trim(),variants:vars,badge:document.getElementById('pBadge').value,badgeText:document.getElementById('pBadgeTxt').value.trim(),img,active:document.getElementById('pActive').value==='true',updatedAt:serverTimestamp()};
  try{
    if(fid){await updateDoc(doc(db,'products',fid),data);toast('‚úÖ Product updated!','success');}
    else{data.createdAt=serverTimestamp();data.sortOrder=prods.length;await addDoc(collection(db,'products'),data);toast('‚úÖ Product added!','success');}
    closeProdModal();loadProds();
  }catch(e){toast('Error: '+e.message,'error');}
  btn.innerHTML='üíæ Save Product to Firebase';btn.disabled=false;
}

window.toggleVis = async function(fid,isActive){
  await updateDoc(doc(db,'products',fid),{active:!isActive});
  toast(isActive?'üëÅ Product hidden':'‚úÖ Product visible','info');
  loadProds();
}

window.confDel = function(fid,name){
  document.getElementById('confTitle').textContent='Delete Product?';
  document.getElementById('confMsg').textContent=`"${name}" will be permanently removed.`;
  document.getElementById('confOk').onclick=async()=>{closeConf();await deleteDoc(doc(db,'products',fid));toast('üóëÔ∏è Product deleted','info');loadProds();};
  document.getElementById('confBg').classList.add('open');
}

// IMAGE
window.onFile = function(input){
  const f=input.files[0];if(!f)return;
  if(f.size>5*1024*1024){toast('Max 5MB','error');return;}
  uploadFile=f;
  const r=new FileReader();r.onload=e=>{const p=document.getElementById('imgPrev');p.src=e.target.result;p.style.display='block';};r.readAsDataURL(f);
  toast('üì∏ Image ready','info');
}
window.dropImg = function(e){
  e.preventDefault();document.getElementById('uploadArea').classList.remove('drag');
  const f=e.dataTransfer.files[0];
  if(f){const dt=new DataTransfer();dt.items.add(f);document.getElementById('imgFile').files=dt.files;onFile(document.getElementById('imgFile'));}
}
window.prevUrl = function(){
  const u=document.getElementById('pImg').value.trim();if(!u)return;
  const p=document.getElementById('imgPrev');p.src=u;p.style.display='block';uploadFile=null;
}

// ORDERS
async function loadOrds(){
  try{
    const snap=await getDocs(query(collection(db,'orders'),orderBy('createdAt','desc')));
    ords=snap.docs.map(d=>({fid:d.id,...d.data()}));
    renderOrds();renderRecent();
    document.getElementById('sOrd').textContent=ords.length;
    const rev=ords.filter(o=>o.status==='paid'||o.status==='completed').reduce((s,o)=>s+(o.totalPaid||0),0);
    document.getElementById('sRev').textContent=fmt(rev);
    const pend=ords.filter(o=>!o.orderStatus||o.orderStatus==='processing'||o.orderStatus==='pending').length;
    document.getElementById('sPend').textContent=pend;
    if(pend>0){document.getElementById('pendingBadge').textContent=pend;document.getElementById('pendingBadge').style.display='inline-flex';}
    buildRefs();
  }catch(e){
    document.getElementById('ordBody').innerHTML='<div class="empty-state"><span class="ei">üì¶</span><p>No orders yet. Customers will appear here after checkout.</p></div>';
    document.getElementById('recentBody').innerHTML='<div class="empty-state"><span class="ei">üì¶</span><p>No orders yet.</p></div>';
    document.getElementById('refBody').innerHTML='<div class="empty-state"><span class="ei">üéÅ</span><p>No referral data yet.</p></div>';
  }
}

window.renderOrds = function(){
  const q=(document.getElementById('oSearch')?.value||'').toLowerCase();
  let list=[...ords];
  if(ordStatusFilter!=='all') list=list.filter(o=>(o.orderStatus||o.status)===ordStatusFilter);
  if(q) list=list.filter(o=>(`${o.customer?.firstName} ${o.customer?.lastName} ${o.customer?.email} ${o.txRef}`).toLowerCase().includes(q));
  const b=document.getElementById('ordBody');
  if(!list.length){b.innerHTML='<div class="empty-state"><span class="ei">üì¶</span><p>No orders found.</p></div>';return;}
  b.innerHTML=`<table><thead><tr><th>Customer</th><th>Items</th><th>Amount</th><th>Status</th><th>Update</th><th>Actions</th></tr></thead><tbody>${list.map(o=>{
    const n=(`${o.customer?.firstName||''} ${o.customer?.lastName||''}`).trim()||'Unknown';
    const st=o.orderStatus||o.status||'pending';
    const items=(o.items||[]).reduce((s,i)=>s+(i.qty||1),0);
    const dt=o.createdAt?.toDate?o.createdAt.toDate().toLocaleDateString('en-NG'):'‚Äî';
    return `<tr>
      <td><div class="td-name">${esc(n)}</div><div class="td-sub">${esc(o.customer?.phone||'')} ¬∑ ${esc(o.customer?.state||'')}</div><div class="td-sub" style="opacity:.6;margin-top:2px">${dt}</div></td>
      <td><div class="td-sub">${items} item${items>1?'s':''}</div><div class="td-sub">${esc((o.shippingMethod||'').substring(0,18))}</div></td>
      <td><div class="td-price">${fmt(o.totalPaid||0)}</div></td>
      <td><span class="badge b-${st}">${sLabel(st)}</span></td>
      <td><select class="status-sel" onchange="updOrdStatus('${o.fid}',this.value)">
        <option value="processing" ${st==='processing'?'selected':''}>üîÑ Processing</option>
        <option value="shipped" ${st==='shipped'?'selected':''}>üöö Shipped</option>
        <option value="delivered" ${st==='delivered'?'selected':''}>üéâ Delivered</option>
        <option value="paid" ${st==='paid'?'selected':''}>‚úÖ Paid</option>
      </select></td>
      <td><div class="act-row">
        <button class="act-btn act-edit" onclick="viewOrd('${o.fid}')" title="View">üëÅ</button>
        <button class="act-btn act-wa" onclick="waMsg('${o.fid}')" title="WhatsApp">üí¨</button>
      </div></td>
    </tr>`;
  }).join('')}</tbody></table>`;
}

function renderRecent(){
  const b=document.getElementById('recentBody');
  if(!ords.length){b.innerHTML='<div class="empty-state"><span class="ei">üì¶</span><p>No orders yet.</p></div>';return;}
  b.innerHTML=`<table><thead><tr><th>Customer</th><th>Amount</th><th>Status</th><th>Date</th></tr></thead><tbody>${ords.slice(0,6).map(o=>{
    const n=(`${o.customer?.firstName||''} ${o.customer?.lastName||''}`).trim()||'Unknown';
    const st=o.orderStatus||o.status||'pending';
    const dt=o.createdAt?.toDate?o.createdAt.toDate().toLocaleDateString('en-NG'):'‚Äî';
    return `<tr><td><div class="td-name">${esc(n)}</div><div class="td-sub">${esc(o.customer?.state||'')}</div></td><td><div class="td-price" style="font-size:.95rem">${fmt(o.totalPaid||0)}</div></td><td><span class="badge b-${st}">${sLabel(st)}</span></td><td style="font-size:.75rem;color:var(--muted2)">${dt}</td></tr>`;
  }).join('')}</tbody></table>`;
}

window.setOrdStatus = function(el,s){
  document.querySelectorAll('#panel-orders .ftab').forEach(t=>t.classList.remove('on'));
  el.classList.add('on');ordStatusFilter=s;renderOrds();
}

window.updOrdStatus = async function(fid,status){
  await updateDoc(doc(db,'orders',fid),{orderStatus:status});
  const o=ords.find(x=>x.fid===fid);if(o) o.orderStatus=status;
  toast('üì¶ Status updated: '+sLabel(status),'success');
}

window.viewOrd = function(fid){
  const o=ords.find(x=>x.fid===fid);if(!o)return;
  const n=(`${o.customer?.firstName||''} ${o.customer?.lastName||''}`).trim();
  document.getElementById('ordRef').textContent='Ref: '+(o.txRef||fid);
  const items=(o.items||[]).map(i=>`<div class="od-row"><span>${esc(i.name)} √ó${i.qty} (${esc(i.variant||'')})</span><span>${fmt((i.price||0)*i.qty)}</span></div>`).join('');
  document.getElementById('ordDetail').innerHTML=`
    <div class="od">
      <div class="od-row"><span>üë§ Customer</span><span>${esc(n)}</span></div>
      <div class="od-row"><span>üìß Email</span><span>${esc(o.customer?.email||'‚Äî')}</span></div>
      <div class="od-row"><span>üì± Phone</span><span>${esc(o.customer?.phone||'‚Äî')}</span></div>
      <div class="od-row"><span>üìç State</span><span>${esc(o.customer?.state||'‚Äî')}</span></div>
      <div class="od-row"><span>üè† Address</span><span>${esc(o.customer?.address||'‚Äî')}</span></div>
      <div class="od-row"><span>üöö Shipping</span><span>${esc(o.shippingMethod||'‚Äî')}</span></div>
      <div class="od-row"><span>üéÅ Referral</span><span>${esc(o.referralCode||'None')}</span></div>
    </div>
    <div style="margin:16px 0 6px;font-size:.62rem;letter-spacing:.16em;text-transform:uppercase;color:var(--gold);font-weight:700">Items Ordered</div>
    <div class="od">${items}<div class="od-row" style="margin-top:6px;padding-top:10px;border-top:1px solid var(--border)"><span style="font-weight:700;color:var(--white)">üí∞ Total Paid</span><span style="color:var(--teal-bright);font-size:1.1rem;font-weight:800">${fmt(o.totalPaid||0)}</span></div></div>
    <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn btn-teal" onclick="waMsg('${fid}')">üí¨ WhatsApp Customer</button>
      <button class="btn btn-ghost" onclick="closeOrdModal()">Close</button>
    </div>`;
  document.getElementById('ordModal').classList.add('open');
}
window.closeOrdModal = function(){document.getElementById('ordModal').classList.remove('open');}

window.waMsg = function(fid){
  const o=ords.find(x=>x.fid===fid);if(!o)return;
  const ph=(o.customer?.phone||'').replace(/\D/g,'');
  if(!ph){toast('No phone on this order','error');return;}
  const msg=`Hi ${o.customer?.firstName||'Customer'}, this is GGS Global Consult.\n\nFollowing up on your order (Ref: ${o.txRef||fid}).\nTotal Paid: ${fmt(o.totalPaid||0)}\n\nItems: ${(o.items||[]).map(i=>`${i.name}√ó${i.qty}`).join(', ')}\n\nKindly reach out if you have any questions. Thank you!`;
  window.open(`https://wa.me/${ph}?text=${encodeURIComponent(msg)}`, '_blank');
}

window.exportCSV = function(){
  const rows=[['Name','Email','Phone','State','Address','Items','Total (‚Ç¶)','Shipping','Status','Referral','Date']];
  ords.forEach(o=>rows.push([
    `${o.customer?.firstName||''} ${o.customer?.lastName||''}`.trim(),
    o.customer?.email||'',o.customer?.phone||'',o.customer?.state||'',o.customer?.address||'',
    (o.items||[]).map(i=>`${i.name}√ó${i.qty}(${i.variant})`).join('; '),
    o.totalPaid||0,o.shippingMethod||'',o.orderStatus||o.status||'',
    o.referralCode||'',o.createdAt?.toDate?o.createdAt.toDate().toLocaleDateString():''
  ]));
  const csv=rows.map(r=>r.map(c=>`"${String(c).replace(/"/g,'""')}"`).join(',')).join('\n');
  const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));
  a.download=`GGS_Orders_${new Date().toISOString().slice(0,10)}.csv`;a.click();
  toast('üì• Exported!','success');
}

// SETTINGS
async function loadSettings(){
  try{
    const s=(await getDoc(doc(db,'settings','site-config'))).data()||{};
    document.getElementById('sAnn').value=s.announcementText||'';
    if(s.countdownDeadline?.toDate) document.getElementById('sDL').value=s.countdownDeadline.toDate().toISOString().slice(0,16);
    document.getElementById('sTotal').value=s.urgencySlots?.total||15;
    document.getElementById('sRem').value=s.urgencySlots?.remaining||7;
    document.getElementById('sRound').value=s.currentRound||'Round 2';
    document.getElementById('sPH').value=s.deliveryFeePH||0;
    document.getElementById('sOther').value=s.deliveryFeeOther||5000;
    document.getElementById('sWA').value=s.whatsappNumber||'2348142717585';
    document.getElementById('sMaint').checked=s.maintenanceMode||false;
    document.getElementById('sAccept').checked=s.acceptingOrders!==false;
    document.getElementById('rB').value=s.referralTiers?.bronze||25000;
    document.getElementById('rS').value=s.referralTiers?.silver||100000;
    document.getElementById('rG').value=s.referralTiers?.gold||200000;
    document.getElementById('rP').value=s.referralTiers?.platinum||500000;
  }catch(e){}
}

window.saveSettings = async function(){
  const dl=document.getElementById('sDL').value;
  const data={announcementText:document.getElementById('sAnn').value.trim(),urgencySlots:{total:parseInt(document.getElementById('sTotal').value)||15,remaining:parseInt(document.getElementById('sRem').value)||7},countdownDeadline:dl?new Date(dl):null,currentRound:document.getElementById('sRound').value.trim(),deliveryFeePH:parseInt(document.getElementById('sPH').value)||0,deliveryFeeOther:parseInt(document.getElementById('sOther').value)||5000,whatsappNumber:document.getElementById('sWA').value.trim(),maintenanceMode:document.getElementById('sMaint').checked,acceptingOrders:document.getElementById('sAccept').checked,referralTiers:{bronze:parseInt(document.getElementById('rB').value)||25000,silver:parseInt(document.getElementById('rS').value)||100000,gold:parseInt(document.getElementById('rG').value)||200000,platinum:parseInt(document.getElementById('rP').value)||500000},updatedAt:serverTimestamp()};
  try{await setDoc(doc(db,'settings','site-config'),data,{merge:true});toast('‚úÖ Settings saved!','success');}
  catch(e){toast('Error: '+e.message,'error');}
}

// REFERRALS
function buildRefs(){
  const map={};
  ords.forEach(o=>{const c=(o.referralCode||'').trim();if(c&&c!=='none'&&c!==''){if(!map[c])map[c]={code:c,count:0,val:0};map[c].count++;map[c].val+=o.totalPaid||0;}});
  const list=Object.values(map).sort((a,b)=>b.count-a.count);
  const b=document.getElementById('refBody');
  if(!list.length){b.innerHTML='<div class="empty-state"><span class="ei">üéÅ</span><p>No referrals recorded yet.</p></div>';return;}
  b.innerHTML=`<table><thead><tr><th>Referral Code</th><th>Orders</th><th>Total Value</th><th>Tier Reached</th></tr></thead><tbody>${list.map(r=>{
    const t=r.count>=10?'üíé Platinum':r.count>=5?'ü•á Gold':r.count>=3?'ü•à Silver':'ü•â Bronze';
    return `<tr><td><div class="td-name">${esc(r.code)}</div></td><td>${r.count} order${r.count>1?'s':''}</td><td><div class="td-price" style="font-size:.95rem">${fmt(r.val)}</div></td><td>${t}</td></tr>`;
  }).join('')}</tbody></table>`;
}
window.filterRefs = function(v){document.querySelectorAll('#refBody tbody tr').forEach(r=>{r.style.display=r.textContent.toLowerCase().includes(v.toLowerCase())?'':'none';});}

// NAVIGATION
window.goto = function(p){
  document.querySelectorAll('.panel').forEach(x=>x.classList.remove('active'));
  document.querySelectorAll('.sb-link').forEach(x=>x.classList.remove('active'));
  document.getElementById('panel-'+p)?.classList.add('active');
  document.getElementById('nav-'+p)?.classList.add('active');
  const t={overview:'Overview',products:'Products',orders:'Orders',settings:'Site Settings',referrals:'Referral Tracker'};
  document.getElementById('topTitle').textContent=t[p]||p;
  if(window.innerWidth<900){document.getElementById('sidebar').classList.remove('open');document.getElementById('sbOverlay').classList.remove('show');}
}

window.toggleSB = function(){document.getElementById('sidebar').classList.toggle('open');document.getElementById('sbOverlay').classList.toggle('show');}
window.closeConf = function(){document.getElementById('confBg').classList.remove('open');}

window.toast = function(msg,type='info'){
  const t=document.getElementById('adminToast');const el=document.getElementById('toastEl');
  el.textContent=msg;el.className='toast-inner t-'+type;t.style.opacity='1';
  clearTimeout(t._t);t._t=setTimeout(()=>{t.style.opacity='0';},3000);
}

// SEED PRODUCTS ‚Äî run window.seedProducts() from browser console once
window.seedProducts = async function(){
  const defs=[
    {id:'T01',name:'iPhone 15 Pro Max',spec:'256GB ¬∑ All Colors ¬∑ Factory Sealed ¬∑ Unlocked ¬∑ Verified Authentic',price:2100000,icon:'üì±',badge:'hot',badgeText:'üî• Bestseller',variants:['Natural Titanium','Blue Titanium','White Titanium','Black Titanium'],img:'https://images.unsplash.com/photo-1695048133142-1a20484d2569?w=600&q=80',category:'tech',active:true,sortOrder:1},
    {id:'T02',name:'iPhone 14 Pro',spec:'256GB ¬∑ All Colors ¬∑ Factory Sealed ¬∑ Verified Authentic',price:1350000,icon:'üì±',badge:'pick',badgeText:'üí∞ Budget Pick',variants:['Space Black','Gold','Silver','Deep Purple'],img:'https://images.unsplash.com/photo-1664478546384-d57ffe74a78c?w=600&q=80',category:'tech',active:true,sortOrder:2},
    {id:'T03',name:'Samsung S24 Ultra',spec:'All Storage Variants ¬∑ Unlocked ¬∑ Original Factory Seal',price:1450000,icon:'üì±',badge:'',badgeText:'',variants:['Titanium Black','Titanium Gray','Titanium Violet','Titanium Yellow'],img:'https://images.unsplash.com/photo-1707148029295-0b24dc8c45e6?w=600&q=80',category:'tech',active:true,sortOrder:3},
    {id:'T04',name:'MacBook Air M2',spec:'256GB SSD ¬∑ 8GB RAM ¬∑ All Colors ¬∑ Original Apple Seal',price:1850000,icon:'üíª',badge:'hot',badgeText:'‚≠ê Top Rated',variants:['Midnight','Starlight','Space Gray','Silver'],img:'https://images.unsplash.com/photo-1611186871348-b1ce696e52c9?w=600&q=80',category:'tech',active:true,sortOrder:4},
    {id:'T05',name:'iPad Air 11" M2',spec:'128GB ¬∑ WiFi ¬∑ All Colors ¬∑ Sealed Apple Box',price:950000,icon:'üì≤',badge:'',badgeText:'',variants:['Blue','Purple','Starlight','Space Gray'],img:'https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w=600&q=80',category:'tech',active:true,sortOrder:5},
    {id:'T06',name:'AirPods Pro 2nd Gen',spec:'USB-C Charging Case ¬∑ Adaptive Audio ¬∑ Original Apple Seal',price:180000,icon:'üéß',badge:'',badgeText:'',variants:['White (Standard)'],img:'https://images.unsplash.com/photo-1588156979435-379b9d802b0a?w=600&q=80',category:'tech',active:true,sortOrder:6},
    {id:'T07',name:'Apple Watch Series 9',spec:'45mm ¬∑ GPS ¬∑ All Colors ¬∑ Sealed Apple Box',price:320000,icon:'‚åö',badge:'new',badgeText:'üÜï New',variants:['Midnight','Starlight','Product Red','Pink'],img:'https://images.unsplash.com/photo-1579586337278-3befd40fd17a?w=600&q=80',category:'tech',active:true,sortOrder:7},
    {id:'T08',name:'Anker PowerBank 20K',spec:'20,000mAh ¬∑ PD Fast Charge ¬∑ Original Packaging',price:45000,icon:'‚ö°',badge:'pick',badgeText:'Add-On',variants:['Black','White'],img:'https://images.unsplash.com/photo-1609091839311-d5365f9ff1c5?w=600&q=80',category:'tech',active:true,sortOrder:8},
    {id:'F01',name:'Designer Crossbody Bag',spec:'50+ styles ¬∑ Premium leather finish ¬∑ All colors',price:70000,icon:'üëú',badge:'new',badgeText:'üíé New Drop',variants:['Black','Brown','Beige/Nude','White','Red','Navy Blue'],img:'https://images.unsplash.com/photo-1548036328-c9fa89d128fa?w=600&q=80',category:'fashion',active:true,sortOrder:9},
    {id:'F02',name:'Luxury Tote Bag',spec:'Structured & soft styles ¬∑ Multiple sizes ¬∑ Premium finish',price:78000,icon:'üëú',badge:'',badgeText:'',variants:['Black','Brown','Beige','Caramel','Grey'],img:'https://images.unsplash.com/photo-1590874103328-eac38a683ce7?w=600&q=80',category:'fashion',active:true,sortOrder:10},
    {id:'F03',name:'Premium Ladies Heels',spec:'Kitten ¬∑ Block ¬∑ Stiletto styles ¬∑ Sizes 36‚Äì42',price:48000,icon:'üë†',badge:'hot',badgeText:'üî• High Demand',variants:['Size 36','Size 37','Size 38','Size 39','Size 40','Size 41','Size 42'],img:'https://images.unsplash.com/photo-1543163521-1bf539c55dd2?w=600&q=80',category:'fashion',active:true,sortOrder:11},
    {id:'F04',name:'Ladies Flats & Loafers',spec:'Leather loafers ¬∑ Ballet flats ¬∑ Sizes 36‚Äì42',price:38000,icon:'üëü',badge:'',badgeText:'',variants:['Size 36','Size 37','Size 38','Size 39','Size 40','Size 41','Size 42'],img:'https://images.unsplash.com/photo-1603808033192-082d6919d3e1?w=600&q=80',category:'fashion',active:true,sortOrder:12},
    {id:'F05',name:"Men's Premium Oxfords",spec:'Genuine leather ¬∑ Sizes 40‚Äì47 ¬∑ Black & Brown',price:55000,icon:'üëû',badge:'',badgeText:'',variants:['Size 40 ‚Äì Black','Size 41 ‚Äì Black','Size 42 ‚Äì Black','Size 43 ‚Äì Black','Size 40 ‚Äì Brown','Size 41 ‚Äì Brown','Size 42 ‚Äì Brown'],img:'https://images.unsplash.com/photo-1614252235316-8c857d38b5f4?w=600&q=80',category:'fashion',active:true,sortOrder:13},
    {id:'F06',name:'Evening Clutch / Mini Bag',spec:'Embellished ¬∑ Plain leather ¬∑ Chain strap ¬∑ All colors',price:38000,icon:'üíº',badge:'',badgeText:'',variants:['Black ‚Äì Plain Leather','Gold ‚Äì Embellished','Silver ‚Äì Embellished','Nude ‚Äì Plain','Red ‚Äì Chain Strap'],img:'https://images.unsplash.com/photo-1566150905458-1bf1fb99e4b8?w=600&q=80',category:'fashion',active:true,sortOrder:14},
  ];
  for(const p of defs){
    const {id,...d}=p;d.createdAt=serverTimestamp();d.updatedAt=serverTimestamp();
    await setDoc(doc(db,'products',id),d);
  }
  toast('‚úÖ 14 products seeded!','success');loadProds();
}
</script>
</body>
</html>
